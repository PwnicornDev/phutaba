ErrorDocument 403 /index.pl?p=err403
ErrorDocument 404 /index.pl?p=err404

ErrorDocument 500 /errors/50x.html
ErrorDocument 502 /errors/50x.html
ErrorDocument 503 /errors/50x.html
ErrorDocument 504 /errors/50x.html

Options -MultiViews

# send content header for browser video playback
AddType video/webm .webm

# Enable Rewrite Engine
RewriteEngine on
RewriteBase /

# force every request to ssl and the same host
# NOTE: change it according your needs, disable in dev environment
#RewriteCond %{HTTP_HOST} !^ernstchan\.com [OR]
#RewriteCond %{HTTPS} !on
#RewriteRule ^ https://ernstchan.com%{REQUEST_URI} [R=301,L]

# if the request does not exist as a directory, pass it to the template system
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([A-Za-z]+)$ index.pl?p=$1 [L,NS,DPI]

# if a directory is requested, always try to use wakaba.pl as index-document
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^([^/]+)/$ $1/wakaba.pl [L]

# requests to banner/[board] are directed to the rotate script
RewriteRule ^banner/([^/]+)$ banner.pl?board=$1 [L,NS]

# rest-paths for pages and threads
RewriteRule ^([^/]+)/seite/(\d+)$ $1/wakaba.pl?task=show&page=$2 [L]
RewriteRule ^([^/]+)/page/(\d+)$ $1/wakaba.pl?task=show&page=$2 [L]
RewriteRule ^([^/]+)/faden/(\d+)$ $1/wakaba.pl?task=show&thread=$2 [L]
RewriteRule ^([^/]+)/thread/(\d+)$ $1/wakaba.pl?task=show&thread=$2 [L]

# allow download of original filenames
RewriteRule ^([^/]+)/src/([^/]+)/([^/]+)$ $1/src/$2 [L,NS,DPI]

# new path for emoticons, can be removed on new installations or if no posts before 2015-04-02 exist anymore
RewriteRule ^img/(trollface\.png)$   img/emotes/$1
RewriteRule ^img/(zahngrinsen\.png)$ img/emotes/$1
RewriteRule ^img/(eisfee\.gif)$      img/emotes/$1
RewriteRule ^img/(fu\.png)$          img/emotes/$1
RewriteRule ^img/(awesome\.png)$     img/emotes/$1
RewriteRule ^img/(schreikopf\.png)$  img/emotes/$1
RewriteRule ^img/(blau\.png)$        img/emotes/$1
RewriteRule ^img/(rot\.png)$         img/emotes/$1
RewriteRule ^img/(marisa\.png)$      img/emotes/$1
